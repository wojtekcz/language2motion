//export 
import Dispatch

// ⏰Time how long it takes to run the specified function, optionally taking
// the average across a number of repetitions.
public func time(repeating: Int = 1, _ f: () -> ()) {
    guard repeating > 0 else { return }
    
    // Warmup
    if repeating > 1 { f() }
    
    var times = [Double]()
    for _ in 1...repeating {
        let start = DispatchTime.now()
        f()
        let end = DispatchTime.now()
        let nanoseconds = Double(end.uptimeNanoseconds - start.uptimeNanoseconds)
        let milliseconds = nanoseconds / 1e6
        times.append(milliseconds)
    }
    // print("average: \(times.reduce(0.0, +)/Double(times.count)) ms,   " +
    //       "min: \(times.reduce(times[0], min)) ms,   " +
    //       "max: \(times.reduce(times[0], max)) ms")
    print("average: \(times.reduce(0.0, +)/Double(times.count)/1000) sec")
}
